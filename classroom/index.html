<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
      <title>Teach Online - Classroom</title>
      <meta charset="utf-8">
    	<meta http-equiv="X-UA-Compatible" content="IE=Edge">
    	<meta name="viewport" content="width=device-width, initial-scale=1">

      <!-- Favicon -->
        <link rel="icon" type="image/png" href="//wbweb.co.in/assets/images/favicon.png">

      <!-- Onpage SEO -->
        <meta name="title" content="">
        <meta name="keyword" content="">
        <meta name="description" content="">

      <!-- Dependencies -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@9/dist/sweetalert2.min.css" id="theme-styles">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
        <link rel="stylesheet" href="../main.css">

      <!-- Theme -->
        <link rel="stylesheet" type="text/css" href="../fonts/font-awesome-4.7.0/css/font-awesome.min.css">
        <link rel="stylesheet" type="text/css" href="../fonts/iconic/css/material-design-iconic-font.min.css">
        <link rel="stylesheet" type="text/css" href="../vendor/animate/animate.css">
        <link rel="stylesheet" type="text/css" href="../vendor/css-hamburgers/hamburgers.min.css">
        <link rel="stylesheet" type="text/css" href="../vendor/animsition/css/animsition.min.css">
        <link rel="stylesheet" type="text/css" href="../vendor/select2/select2.min.css">
        <link rel="stylesheet" type="text/css" href="../vendor/daterangepicker/daterangepicker.css">
        <link rel="stylesheet" type="text/css" href="../css/util.css">
        <link rel="stylesheet" type="text/css" href="../css/main.css">

        <style media="screen">
        .course-container {
          width: 100%;
          background: #fff;
          border-radius: 10px;
          overflow: hidden;
          box-shadow: 0 3px 20px 0px rgba(0, 0, 0, 0.1);
          -moz-box-shadow: 0 3px 20px 0px rgba(0, 0, 0, 0.1);
          -webkit-box-shadow: 0 3px 20px 0px rgba(0, 0, 0, 0.1);
          -o-box-shadow: 0 3px 20px 0px rgba(0, 0, 0, 0.1);
          -ms-box-shadow: 0 3px 20px 0px rgba(0, 0, 0, 0.1);
        }

        .login100-button-a {
          font-size: 16px;
          border-radius: 50%;
          color: #3b5998;
          display: -webkit-box;
          display: -webkit-flex;
          display: -moz-box;
          display: -ms-flexbox;
          display: flex;
          justify-content: center;
          align-items: center;
          width: 30px;
          height: 30px;
          background-color: #ffffff;
          margin: 5px;
          box-shadow: 0 5px 20px 0px rgba(0, 0, 0, 0.42);
          -moz-box-shadow: 0 5px 20px 0px rgba(0, 0, 0, 0.42);
          -webkit-box-shadow: 0 5px 20px 0px rgba(0, 0, 0, 0.42);
          -o-box-shadow: 0 5px 20px 0px rgba(0, 0, 0, 0.42);
          -ms-box-shadow: 0 5px 20px 0px rgba(0, 0, 0, 0.42);

          -webkit-transform: perspective(1px) translateZ(0);
          transform: perspective(1px) translateZ(0);
          -webkit-transition-duration: 0.5s;
          transition-duration: 0.5s;
          cursor: pointer;
        }

        .login100-button-a:hover, .login100-button-a:focus, .login100-button-a:active {
          box-shadow: -1px 1px 18px 0 #007bffa8;
          -moz-box-shadow: -1px 1px 18px 0 #007bffa8;
          -webkit-box-shadow: -1px 1px 18px 0 #007bffa8;
          -o-box-shadow: -1px 1px 18px 0 #007bffa8;
          -ms-box-shadow: -1px 1px 18px 0 #007bffa8;

          -webkit-transform: scale(1.2);
          transform: scale(1.2);
          -webkit-transition-timing-function: cubic-bezier(0.47, 2.02, 0.31, -0.36);
          transition-timing-function: cubic-bezier(0.47, 2.02, 0.31, -0.36);
        }

        .class-code {
          font-weight: 600;
          letter-spacing: 2px;
          font-size: 14px;
          padding: 2px 8px;
          border-radius: 20px;
          color: white;
          -webkit-transform: perspective(1px) translateZ(0);
          transform: perspective(1px) translateZ(0);
          -webkit-transition-duration: 0.5s;
          transition-duration: 0.5s;
          cursor: pointer;
        }

        .class-code:hover, .class-code:focus, .class-code:active {
          -webkit-transform: scale(1.2);
          transform: scale(1.2);
          -webkit-transition-timing-function: cubic-bezier(0.47, 2.02, 0.31, -0.36);
          transition-timing-function: cubic-bezier(0.47, 2.02, 0.31, -0.36);
        }

        .dropdown-menu.show {
          box-shadow: 0 5px 20px 0px rgba(0, 0, 0, 0.42);
          border: 0;
        }

        dropdown-item:focus, .dropdown-item:hover {
          background-color: rgba(115, 127, 140, 0.25);
        }

        .card-title{
          font-weight: 600;
        }

        </style>
  </head>
  <body class="loading">
    <div id="nav">

    </div>
    <div id="app">

    </div>
    <div class="modalspin"><!-- Pre-Loader --></div>
    <div class="modal fade" id="apimodal" tabindex="-1" role="dialog">
  </body>
    <!-- General Dependencies -->
    <script src="https://www.chartjs.org/dist/2.9.3/Chart.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js" ></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" ></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9/dist/sweetalert2.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
    <script src="https://apis.google.com/js/platform.js"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="auth.js"></script>
    <script src="../config.js"></script>
    <script src="../main.js"></script>
    <script src="app.js"></script>


    <!-- theme -->
  	<script src="../vendor/animsition/js/animsition.min.js"></script>
  	<script src="../vendor/select2/select2.min.js"></script>
  	<script src="../vendor/daterangepicker/moment.min.js"></script>
  	<script src="../vendor/daterangepicker/daterangepicker.js"></script>
  	<script src="../vendor/countdowntime/countdowntime.js"></script>
    <script src="../js/main.js"></script>

    <!-- Classroom Dependencies -->
    <!-- <script src="js/courses.js"></script>
    <script src="js/courses.students.js"></script>
    <script src="js/courses.announcements.js"></script>
    <script src="js/courses.courseWork.js"></script>
    <script src="js/courses.courseWork.studentSubmissions.js"></script>
    <script src="js/courses.teachers.js"></script>
    <script src="js/courses.topic.js"></script>
    <script src="js/courses.aliases.js"></script>
    <script src="js/invitations.js"></script>
    <script src="js/userprofiles.js"></script>
    <script src="js/userprofiles.guardians.js"></script>
    <script src="js/userprofiles.guardianinvitations.js"></script> -->

    <script>
    $body = $("body");
    $('.class-code').hover(
      function () {
        $(this).html($(this).attr("code"));
      },
      function () {
        $(this).html($(this).attr("default"));
      }
    );
    var crs;

    $('#app').empty().html(initDOM());

      function startApp() {
        $('#nav').empty().html(initNavDOM());
        initCourses();
      }

      function initCourses() {
        return gapi.client.classroom.courses.list({})
        .then(function(response) {
          // Handle the results here (response.result has the parsed body).

          //get DOM of courses
          console.log(response);
          print=coursesDOM(response.result.courses);

          //print courses in page
          $('#course-container').empty().html(print);
          $('[data-toggle="tooltip"]').tooltip();
          stopPreloader();
        },
        function(err) { console.error("Execute error", err); });
      }



      function initDOM() {
        print='<div class="container-login100" style="background-image: url('+"'"+'../images/bg-01.jpg'+"'"+');">'
                +'<div class="course-container p-4" >'
                  +'<div class="row">'
                    +'<div class="col text-left">'
                      +'<span class="login100-form-title p-b-10" style="text-align: left;">Classroom Courses</span>'
                    +'</div>'
                    +'<div class="col-2">'
                      +'<div class="flex-c" style="justify-content: flex-end;">'
                        +'<div class="dropleft">'
                          +'<button class="login100-button-a" data-toggle="dropdown" title="Settings" type="button" id="dropdownCoursesMenu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><i class="fa fa-ellipsis-v"></i></button>'
                          +'<div class="dropdown-menu" aria-labelledby="dropdownCoursesMenu">'
                            +'<a class="dropdown-item" href="javascript:void(0)" onclick="modalAddCourse()">Add New Course</a>'
                          +'</div>'
                        +'</div>'
                      +'</div>'
                    +'</div>'
                  +'</div>'
                  +'<div class="row p-t-30 p-b-30" id="course-container" style="max-height:500px; overflow:scroll">'
                  +'</div>'
                +'</div>'
              +'</div>';

        return print;
      }

      function coursesDOM(courses) {
        console.log('dom call success');
        print='';
          for(i=0; i<courses.length; i++){
            console.log(courses[i]);
              print+='<div class="col-sm-6 col-md-4 col-lg-3">'
                      +'<div class="card bg-white mb-3" style="width: auto;">'
                       +'<div class="card-header">'
                          +'<div class="row">'
                           +'<div class="col text-left">'
                           +'<h5 class="card-title mb-0">'+courses[i].name+' - '+courses[i].section+'</h5>'
                           +'</i><span class="class-code bg-light" onclick="Toast.fire({title:'+"'"+courses[i].enrollmentCode+"',icon:'success'"+'})"  data-toggle="tooltip" title="Class Code">'+courses[i].enrollmentCode+'</span></i>'
                           +'</div>'
                           +'<div class="col-2">'
                            +'<div class="flex-c" style="justify-content: flex-end;">'
                              +'<div class="dropleft">'
                                +'<button class="login100-button-a" data-toggle="dropdown" title="Course Settings" aria-haspopup="true" aria-expanded="false"><i class="fa fa-ellipsis-v"></i></button>'
                                +'<div class="dropdown-menu">'
                                  +'<a class="dropdown-item" href="javascript:void(0)" onclick="modalEditCourse('+courses[i].id+')">Edit Course</a>'
                                  +'<a class="dropdown-item" href="javascript:void(0)" onclick="modalDeleteCourse('+courses[i].id+')">Delete Course</a>'
                                +'</div>'
                              +'</div>'
                            +'</div>'
                            +'</div>'
                          +'</div>'
                       +'</div>'
                       +'<div class="card-body">'
                         +'<p data-toggle="tooltip" title="View Students"> Students: <span id="'+courses[i].id+'-students">0<span></p>'
                         +'<p class="mb-2" data-toggle="tooltip" title="View Teachers"> Teachers: <span id="'+courses[i].id+'-teachers">0<span></p>'
                         +'<p data-toggle="tooltip" title="View Announcements"> Announcements: <span id="'+courses[i].id+'-announcements">0<span></p>'
                         +'<p data-toggle="tooltip" title="View CourseWorks"> CourseWorks: <span id="'+courses[i].id+'-corseWorks">0<span></p>'
                         +'<p class="mb-2" data-toggle="tooltip" title="View Topics"> Topics: <span id="'+courses[i].id+'-topics">0<span></p>'
                         +'<p data-toggle="tooltip" title="View Live Classes"> Live Classes: <span id="'+courses[i].id+'-liveclasses">0<span></p>'
                       +'</div>'
                       +'<div class="card-footer">'
                         +'<div class="flex-c">'
                           +'<a class="login100-button-a" href="javascript:void(0)" data-toggle="tooltip" title="Add Announcement" onclick="modalAddAnnouncement('+"'"+courses[i].id+"'"+')"><i class="fa fa-bullhorn"></i></a>'
                           +'<a class="login100-button-a" href="'+courses[i].alternateLink+'" target="_blank" class="card-text" data-toggle="tooltip" title="Open in google Classroom"><i class="fa fa-link"></i></a>'
                           +'<a class="login100-button-a" href="javascript:void(0)" data-toggle="tooltip" title="View Class content in Google Drive"><i class="fa fa-folder"></i></a>'
                           +'<a class="login100-button-a" href="javascript:void(0)" class="card-text" data-toggle="tooltip" onclick="modalAddLiveClass('+"'"+courses[i].id+"'"+')" title="Add/Schedule Live Class"><i class="fa fa-video-camera"></i></a>'
                           +'<a class="login100-button-a" href="javascript:void(0)" data-toggle="tooltip" title="Invitations Teacher/Student" onclick="modalInvitation('+"'"+courses[i].id+"'"+')"><i class="fa fa-users"></i></a>'
                         +'</div>'
                       +'</div>'
                      +'</div>'
                    +'</div>';
                    getCourseDataCounts(courses[i].id);
            }
        return print;
      }

      function getCourseDataCounts(courseId) {
        classroomCoursesStudentsCount(courseId);
        classroomCoursesTeachersCount(courseId);

        classroomCoursesAnnouncementsCount(courseId);
        classroomCoursesCourseWorkCount(courseId);
        classroomCoursesTopicsCount(courseId);
        classroomCoursesAliasesCount(courseId);
      }


      function modalEditCourse(courseID) {
        console.log('Modal Clicked');
        $('#apimodal').empty().html(initModalDOM());
        $('#apimodaltitle').html('Edit Course');

        print='<div class="row">'
              +'<div class="col-md-12">'
                +'<div class="form-group">'
                  +'<label>Course Name</label>'
                  +'<input type="text" max="50" value="" id="courseName" class="form-control">'
                +'</div>'
              +'</div>'
            +'</div>'
            +'<div class="row">'
              +'<div class="col-md-4">'
                +'<div class="form-group">'
                  +'<label>Section</label>'
                  +'<input value="" type="text" max="10" id="courseSection" class="form-control">'
                +'</div>'
              +'</div>'
              +'<div class="col-md-4">'
                +'<div class="form-group">'
                  +'<label>Room</label>'
                  +'<input value="" type="text" max="10" id="courseRoom" class="form-control">'
                +'</div>'
              +'</div>'
              +'<div class="col-md-4">'
                +'<div class="form-group">'
                  +'<label>Course State</label>'
                  +'<select id="courseState" class="form-control">'
                    +'<option>ACTIVE</option>'
                    +'<option>ARCHIVED</option>'
                    +'<option>PROVISIONED</option>'
                    +'<option>DECLINED</option>'
                    +'<option>SUSPENDED</option>'
                  +'</select>'
                +'</div>'
              +'</div>'
            +'</div>'
            +'<div class="row">'
              +'<div class="col-md-12">'
                +'<div class="form-group">'
                  +'<label>Course Description</label>'
                  +'<input value="" type="text" max="200" id="courseDescriptionHeading" class="form-control">'
                +'</div>'
              +'</div>'
            +'</div>'
            +'<div class="row">'
              +'<div class="col-md-12 text-center">'
                +'<div class="form-group">'
                  +'<input type="button" onclick="initclassroomCoursesUpdate('+courseID+')" value="Update" class="btn btn-primary btn-md" >'
                +'</div>'
              +'</div>'
            +'</div>';
        $('#apimodalform').empty().html(print);
        console.log('Modal Form print success');
        classroomCoursesGetFormValue(courseID);
        $('#apimodal').modal('show');
      }

      function initclassroomCoursesUpdate(courseID) {
        classroomCoursesUpdate(courseID,classroomCoursesFormToDataObject());
      }

      function classroomCoursesFormToDataObject() {
        data = {
          name: $("#courseName").val(),
          section: $("#courseSection").val(),
          room: $("#courseRoom").val(),
          courseState: $("#courseState").val(),
          descriptionHeading: $("#courseDescriptionHeading").val()
        }
        return data;
      }

      function classroomCoursesGetFormValue(id) {
        return gapi.client.classroom.courses.get({"id": id})
        .then(function(response) {
          // Handle the results here (response.result has the parsed body).
          console.log("Response", response);

          $("#courseName").val(response.result.name);
          $("#courseSection").val(response.result.section);
          $("#courseRoom").val(response.result.room);
          $("#courseState").val(response.result.courseState);
          $("#courseDescriptionHeading").val(response.result.descriptionHeading);
          console.log('Form value put success');
        },
        function(err) { console.error("Execute error", err); });
      }

      function initModalDOM() {
        console.log('Modal Init Success');
        print='<div class="modal-dialog" role="document">'
          +'<div class="modal-content">'
            +'<div class="modal-header">'
            +'<h5 class="modal-title" id="apimodaltitle"></h5>'
            +'<button type="button" class="close" data-dismiss="modal" aria-label="Close">'
                +'<i class="fa fa-close"></i>'
            +'</button>'
            +'</div>'
            +'<div class="modal-body">'
              +'<form id="apimodalform" onsubmit="return false;"></form>'
            +'</div>'
            +'<div class="modal-footer">'
              +'<button type="button" class="btn btn-danger btn-sm btn btn-link text-white" data-dismiss="modal">Close</button>'
            +'</div>'
          +'</div>'
        +'</div>';
        return print;
      }


      function classroomCoursesUpdate(id,data) {
        return gapi.client.classroom.courses.update({
            "id": id,
            "resource": data
          })
        .then(function(response) {
          // Handle the results here (response.result has the parsed body).
          console.log("Response", response);
          Toast.fire({
            title:"Update Suceess",
            icon: "success"
          });
          $('#apimodal').modal('hide');
          initCourses();
        },
        function(err) { console.error("Execute error", err); });
      }



      handleClientLoad();

      function initNavDOM() {
        var current = gapi.auth2.getAuthInstance().currentUser.get();
        print = +'<nav class="navbar sticky-top navbar-light">'
          +'<div class="card text-right" style="width=auto;max-height:70px;min-height: 70px;border: none;border-radius: 8px;width: 100%;background: #fffffff0; box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2);">'
            +'<div class="row">'
              +'<div class="col-10 col-md-3 offset-md-8 text-center text-md-right" style="padding: 0;">'
              +'<p style="font-size: 16px;font-weight: 800;margin-top: 15px;">Welcome, '+current.Pt.pW+'</p>'
              +'</div>'
              +'<div class="col-2 col-md-1 text-right" style="padding: 10px;">'
                +'<img src="'+current.Pt.QK+'" height="50px" width="50px" style="border-radius: 50%;">'
              +'</div>'
            +'</div>'
          +'</div>'
        +'</nav>';

        return print;
      }

    </script>








</html>
